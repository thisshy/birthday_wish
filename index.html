<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>é€ç»™æ¨æ¬£æ€¡å®å®çš„ç”Ÿæ—¥ç¥ç¦ ğŸ‚</title>

<style>
/* ====== Reset & Base ====== */
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family:"Comic Sans MS","Segoe UI","PingFang SC","å¾®è½¯é›…é»‘",system-ui,sans-serif;
  background:#fff0f5;color:#333;overflow:hidden;
}
/* ====== Layout ====== */
.container{position:relative;width:100%;height:100%}
.bg-wrapper{position:absolute;inset:0;overflow:hidden}
.bg-photo{
  position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
  max-width:120%;max-height:120%;filter:brightness(.85);
  transition:transform .8s ease;user-select:none;-webkit-user-drag:none
}
.bg-photo:hover{transform:translate(-50%,-50%) scale(1.04)}
.overlay{position:absolute;inset:0;background:rgba(255,240,245,.55);pointer-events:none}
.content{
  position:relative;z-index:2;width:min(860px,92vw);margin:0 auto;text-align:center;
  top:18%;padding:0 12px
}
h1{font-size:clamp(24px,5vw,38px);color:#c71585;letter-spacing:.5px;margin-bottom:.8rem;opacity:0;transform:translateY(-6px)}
.message{font-size:clamp(16px,3.8vw,22px);color:#7a0033;line-height:1.75;min-height:6.5em;opacity:0;transform:translateY(6px)}
.btns{margin-top:1.1rem;display:inline-flex;gap:.6rem}
/* ====== Buttons ====== */
.btn{
  padding:12px 22px;border:none;border-radius:999px;font-size:16px;cursor:pointer;
  box-shadow:0 6px 18px rgba(255,135,171,.35);
  transition:transform .12s ease,box-shadow .12s ease,background .2s ease;user-select:none
}
.btn:active{transform:translateY(1px) scale(.97)}
.btn.primary{background:#ff87ab;color:#fff}
.btn.primary:hover{box-shadow:0 10px 24px rgba(255,135,171,.55)}
.btn.ghost{background:#ffe3ec;color:#b2185c}
.btn.ghost:hover{box-shadow:0 10px 24px rgba(255,195,215,.55)}
.btn-top{
  position:fixed;right:18px;bottom:26px;z-index:3;width:44px;height:44px;border-radius:50%;
  border:none;background:#ffc0cb;color:#7a0033;font-weight:700;box-shadow:0 6px 16px rgba(0,0,0,.15);
  cursor:pointer;opacity:0;transition:opacity .35s ease
}
/* ====== Particles ====== */
.heart,.star{position:absolute;pointer-events:none}
.heart{width:16px;height:16px;background:#ff4d6d;transform:rotate(45deg);opacity:0}
.heart::before,.heart::after{content:"";position:absolute;width:16px;height:16px;background:#ff4d6d;border-radius:50%}
.heart::before{top:-8px;left:0}.heart::after{left:8px;top:0}
.star{width:4px;height:4px;background:#fff;border-radius:50%;box-shadow:0 0 8px #fff,0 0 14px rgba(255,255,255,.75);opacity:0}
/* ====== Toast ====== */
.toast{
  position:fixed;left:50%;bottom:18px;transform:translateX(-50%);
  background:rgba(0,0,0,.72);color:#fff;padding:10px 14px;border-radius:12px;
  font-size:14px;letter-spacing:.3px;z-index:4;opacity:0;pointer-events:none;
  transition:opacity .25s ease,transform .25s ease
}
.toast.show{opacity:1;transform:translate(-50%,-4px)}
/* ====== Reveal ====== */
.reveal{opacity:1 !important;transform:none !important}
@media (max-height:640px){.content{top:12%}}
</style>
</head>

<body>
  <div class="container">
    <div class="bg-wrapper">
      <!-- é»˜è®¤å°è¯• assets/your_photo.jpgï¼›å¤±è´¥ä¼šè‡ªåŠ¨æ¢ assets/photo.jpg -->
      <img class="bg-photo" id="bgPhoto" src="assets/your_photo.jpg" alt="å®è´ç…§ç‰‡" />
      <div class="overlay"></div>
    </div>

    <main class="content">
      <h1 id="title">ç»™æ¨æ¬£æ€¡å®å®</h1>
      <p id="message" class="message" aria-live="polite"></p>
      <div class="btns">
        <button class="btn primary" id="btnPlay" aria-pressed="false">æ’­æ”¾éŸ³ä¹ ğŸµ</button>
        <button class="btn ghost" id="btnBurst">å†æ¥ç‚¹ç‰¹æ•ˆ âœ¨</button>
      </div>
    </main>

    <button class="btn-top" id="btnTop" title="å›åˆ°é¡¶éƒ¨">â†‘</button>
  </div>

  <!-- éŸ³ä¹ï¼šé»˜è®¤å°è¯• assets/birthday_song.mp3ï¼›å¤±è´¥è‡ªåŠ¨æ¢ assets/music.mp3ï¼›å†å¤±è´¥è‡ªåŠ¨æ˜¾ç¤ºåŸç”Ÿæ§ä»¶ -->
  <audio id="bgm" preload="auto" loop></audio>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

<script>
/* ================== å¯æ”¹çš„é…ç½® ================== */
const CONF = {
  // è‹¥ä½ æ‰§æ„ç”¨ç»å¯¹è·¯å¾„ï¼ˆä»…æœ¬æœºç”Ÿæ•ˆï¼‰ï¼ŒæŠŠä¸‹é¢æ”¹ä¸º trueï¼Œå¹¶å¡«ä½ çš„è·¯å¾„ï¼ˆæ³¨æ„ file:/// å’Œæ­£æ–œæ ï¼‰
  USE_ABSOLUTE: false,
  ABS_IMG: "file:///C:/Users/admin/Desktop/birthday_wish/assets/your_photo.jpg",
  ABS_MP3: "file:///C:/Users/admin/Desktop/birthday_wish/assets/birthday_song.mp3",

  // ç›¸å¯¹è·¯å¾„ï¼ˆæ¨èï¼Œæ–¹ä¾¿æ‰“åŒ…&ä¸Šçº¿ï¼‰
  IMG_TRY: ["assets/your_photo.jpg", "assets/photo.jpg"],
  MP3_TRY: ["assets/birthday_song.mp3", "assets/music.mp3"],

  LINES: [
    "äº²çˆ±çš„æ¨æ¬£æ€¡å®å®ï¼Œ",
    "ä»Šå¤©æ˜¯ä½ çš„ç”Ÿæ—¥ï¼Œæˆ‘æƒ³å¯¹ä½ è¯´ï¼š",
    "æ„¿ä½ ç¬‘é¢œå¸¸åœ¨ï¼Œå¹¸ç¦å¦‚å½±éšå½¢ï¼›",
    "æ„¿ä½ çš„æ¯ä¸ªæ„¿æœ›ï¼Œéƒ½è¢«æ¸©æŸ”å¯¹å¾…ï¼›",
    "æœªæ¥çš„è·¯ï¼Œæˆ‘ä»¬ä¸€èµ·æ…¢æ…¢èµ°ï½",
    "ç”Ÿæ—¥å¿«ä¹ï¼æˆ‘æœ€æœ€çˆ±ä½  ğŸ’–"
  ]
};

/* ================== å°å·¥å…· ================== */
const $ = s => document.querySelector(s);
const sleep = ms => new Promise(r => setTimeout(r, ms));
function toast(msg, ms=1800){const t=$("#toast");t.textContent=msg;t.classList.add("show");setTimeout(()=>t.classList.remove("show"),ms);}

/* ================== èµ„æºåŠ è½½ï¼ˆå«å®¹é”™ï¼‰ ================== */
(function setupMedia(){
  const img = $("#bgPhoto");
  const audio = $("#bgm");

  if (CONF.USE_ABSOLUTE) {
    img.src = CONF.ABS_IMG;
    audio.src = CONF.ABS_MP3;
  } else {
    // å›¾ç‰‡å°è¯•ï¼šyour_photo.jpg â†’ photo.jpg
    img.addEventListener("error", function onErr(){
      if (img.src.endsWith(CONF.IMG_TRY[0])) img.src = CONF.IMG_TRY[1];
      img.removeEventListener("error", onErr);
    });
    // éŸ³ä¹å°è¯•ï¼šbirthday_song.mp3 â†’ music.mp3
    let triedAlt = false;
    audio.src = CONF.MP3_TRY[0];
    audio.addEventListener("error", function onErr(){
      if (!triedAlt) { triedAlt = true; audio.src = CONF.MP3_TRY[1]; audio.load(); }
      else { audio.setAttribute("controls",""); toast("æœªæ‰¾åˆ°éŸ³ä¹ï¼Œå·²æ˜¾ç¤ºæ’­æ”¾å™¨æ§ä»¶ï½"); }
    });
  }
})();

/* ================== æ‰“å­—æœº ================== */
async function typeWriter(el, lines, speed=55){
  el.innerHTML=""; for(let i=0;i<lines.length;i++){const t=lines[i];
    for(let j=0;j<t.length;j++){el.innerHTML+=t[j]; await sleep(speed);}
    if(i<lines.length-1){el.innerHTML+="<br/>"; await sleep(260);}
  }
}

/* ================== ç²’å­ç‰¹æ•ˆ ================== */
function createHeart(){
  const h=document.createElement("div"); h.className="heart";
  const size=Math.random()*18+12; h.style.width=h.style.height=size+"px";
  h.style.left=Math.random()*window.innerWidth+"px"; h.style.top=window.innerHeight+20+"px";
  document.body.appendChild(h);
  let top=window.innerHeight+20; const speed=1+Math.random()*1.5; const drift=(Math.random()-.5)*1.6;
  (function step(){ top-=speed; h.style.top=top+"px"; h.style.left=(parseFloat(h.style.left)+drift)+"px";
    h.style.opacity=Math.max(0, top/window.innerHeight);
    top<-40 ? h.remove() : requestAnimationFrame(step);
  })();
}
function createStar(){
  const s=document.createElement("div"); s.className="star";
  s.style.left=Math.random()*window.innerWidth+"px"; s.style.top=Math.random()*window.innerHeight+"px";
  document.body.appendChild(s); s.style.transition="opacity 1s ease-in-out";
  requestAnimationFrame(()=>s.style.opacity=1); setTimeout(()=>{s.style.opacity=0; setTimeout(()=>s.remove(),900);},260);
}

/* ================== éŸ³ä¹æ§åˆ¶ï¼ˆå¸¦è°ƒè¯•&é™çº§ï¼‰ ================== */
const audio=$("#bgm"), btnPlay=$("#btnPlay");
["loadstart","loadedmetadata","canplay","canplaythrough","play","pause","error"].forEach(ev=>{
  audio.addEventListener(ev,()=>console.log("[AUDIO]",ev,{readyState:audio.readyState,error:audio.error}));
});
async function togglePlay(){
  try{
    audio.muted=false; audio.volume=1;
    if(audio.paused){ await audio.play(); btnPlay.textContent="æš‚åœéŸ³ä¹ ğŸµ"; btnPlay.setAttribute("aria-pressed","true"); toast("éŸ³ä¹å·²æ’­æ”¾ï½"); }
    else{ audio.pause(); btnPlay.textContent="æ’­æ”¾éŸ³ä¹ ğŸµ"; btnPlay.setAttribute("aria-pressed","false"); }
  }catch(e){ console.error(e); toast("æ’­æ”¾å¤±è´¥ï¼šè¯·æ£€æŸ¥éŸ³ä¹è·¯å¾„æˆ–æ‰‹åŠ¨å…è®¸å£°éŸ³"); audio.setAttribute("controls",""); }
}

/* ================== äº¤äº’ç»‘å®š & åˆå§‹åŒ– ================== */
window.addEventListener("load", async ()=>{
  $("#title").classList.add("reveal"); await sleep(400); $("#message").classList.add("reveal");
  typeWriter($("#message"), CONF.LINES, 55);

  // ç²’å­
  setInterval(createHeart, 900);
  setInterval(createStar, 420);

  // æŒ‰é’®
  btnPlay.addEventListener("click", togglePlay);
  $("#btnBurst").addEventListener("click", ()=>{
    for(let i=0;i<22;i++) setTimeout(createHeart,i*36);
    for(let i=0;i<36;i++) setTimeout(createStar,i*18);
  });

  // è¿”å›é¡¶éƒ¨ï¼ˆæœ¬é¡µåŸºæœ¬ä¸æ»šåŠ¨ï¼Œä½†ä»¥é˜²ä¸‡ä¸€ï¼‰
  const btnTop=$("#btnTop");
  const toggleTop=()=>window.pageYOffset>80 ? btnTop.style.opacity=1 : btnTop.style.opacity=0;
  document.addEventListener("scroll",toggleTop);
  btnTop.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"}));
});
</script>
</body>
</html>
